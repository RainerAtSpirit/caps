/*! caps 0.19.3 
* Copyright (c) 1998, 2014 Spirit EDV-Beratung AG 
* Available via the MIT license.
* see: https://github.com/RainerAtSpirit/caps for details.
*/
!function(a,b){"function"==typeof define&&define.amd?define(b):a.caps=b()}(this,function(){var a,b,c;return function(d){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(n=n.slice(0,n.length-1),a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(a,b){return function(){return n.apply(d,v.call(arguments,0).concat([a,b]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var b=r[a];delete r[a],t[a]=!0,m.apply(d,b)}if(!e(q,a)&&!e(t,a))throw new Error("No "+a);return q[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(a,b,c,f){var h,k,l,m,n,s,u=[],v=typeof c;if(f=f||a,"undefined"===v||"function"===v){for(b=!b.length&&c.length?["require","exports","module"]:b,n=0;n<b.length;n+=1)if(m=o(b[n],f),k=m.f,"require"===k)u[n]=p.require(a);else if("exports"===k)u[n]=p.exports(a),s=!0;else if("module"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=c?c.apply(q[a],u):void 0,a&&(h&&h.exports!==d&&h.exports!==q[a]?q[a]=h.exports:l===d&&s||(q[a]=l))}else a&&(q[a]=c)},a=b=n=function(a,b,c,e,f){if("string"==typeof a)return p[a]?p[a](b):j(o(a,b).f);if(!a.splice){if(s=a,s.deps&&n(s.deps,s.callback),!b)return;b.splice?(a=b,b=c,c=null):a=d}return b=b||function(){},"function"==typeof c&&(c=e,e=f),e?m(d,a,b,c):setTimeout(function(){m(d,a,b,c)},4),n},n.config=function(a){return n(a)},a._defined=q,c=function(a,b,c){b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},c.amd={jQuery:!0}}(),c("almond",function(){}),c("fn/events",["require"],function(){var a=Object.keys,b=/\s+/,c=function(){},d=function(a,b){this.owner=a,this.events=b};return d.prototype.then=function(a,b){return this.callback=a||this.callback,this.context=b||this.context,this.callback?(this.owner.on(this.events,this.callback,this.context),this):this},d.prototype.on=d.prototype.then,d.prototype.off=function(){return this.owner.off(this.events,this.callback,this.context),this},c.prototype.on=function(a,c,e){var f,g,h;if(c){for(f=this.callbacks||(this.callbacks={}),a=a.split(b);g=a.shift();)h=f[g]||(f[g]=[]),h.push(c,e);return this}return new d(this,a)},c.prototype.off=function(c,d,e){var f,g,h,i;if(!(g=this.callbacks))return this;if(!(c||d||e))return delete this.callbacks,this;for(c=c?c.split(b):a(g);f=c.shift();)if((h=g[f])&&(d||e))for(i=h.length-2;i>=0;i-=2)d&&h[i]!==d||e&&h[i+1]!==e||h.splice(i,2);else delete g[f];return this},c.prototype.trigger=function(a){var c,d,e,f,g,h,i,j;if(!(d=this.callbacks))return this;for(j=[],a=a.split(b),f=1,g=arguments.length;g>f;f++)j[f-1]=arguments[f];for(;c=a.shift();){if((i=d.all)&&(i=i.slice()),(e=d[c])&&(e=e.slice()),e)for(f=0,g=e.length;g>f;f+=2)e[f].apply(e[f+1]||this,j);if(i)for(h=[c].concat(j),f=0,g=i.length;g>f;f+=2)i[f].apply(i[f+1]||this,h)}return this},c.prototype.proxy=function(a){var b=this;return function(c){b.trigger(a,c)}},c.includeIn=function(a){a.on=c.prototype.on,a.off=c.prototype.off,a.trigger=c.prototype.trigger,a.proxy=c.prototype.proxy},c}),c("helper/polyfills",[],function(){Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var f,g,h=[];for(f in e)a.call(e,f)&&h.push(f);if(b)for(g=0;d>g;g++)a.call(e,c[g])&&h.push(c[g]);return h}}()),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){if(null==this)throw new TypeError;var b,c,d=Object(this),e=d.length>>>0;if(0===e)return-1;for(b=e,arguments.length>1&&(b=Number(arguments[1]),b!=b?b=0:0!=b&&b!=1/0&&b!=-(1/0)&&(b=(b>0||-1)*Math.floor(Math.abs(b)))),c=b>=0?Math.min(b,e-1):e-Math.abs(b);c>=0;c--)if(c in d&&d[c]===a)return c;return-1})}),c("fn/common",[],function(){function a(){for(var a=Array.prototype.slice.call(arguments),b=a.shift(),c=0;c<a.length;c++){if(!b.hasOwnProperty(a[c]))return!1;b=b[a[c]]}return!0}function b(a,b){return b="object"==typeof b?b:Array.prototype.slice.call(arguments,1),a.replace(/\{\{|\}\}|\{(\w+)\}/g,function(a,c){return"{{"===a?"{":"}}"===a?"}":b[c]})}function c(a){var b="/_layouts/CorasWorksApps/CorasWorksApplicationService.ashx",c=a.url||b,d={data:null,dataType:"json"};return a.url&&delete a.url,$.ajax(c,$.extend(!0,d,a))}function d(a){return a=a||"/AppPages","undefined"!=typeof L_Menu_BaseUrl?L_Menu_BaseUrl:location.pathname.split(a)[0]}return{checkNested:a,format:b,getPromise:c,getSiteUrl:d}}),c("processBatchData/createBatchXML",["require","jquery","fn/common"],function(a){function b(a){function b(a){var b,d=c.isArray(a.batch)?a.batch:[a.batch],f=d.length;for(b=0;f>b;b++)e(a.name,d[b])}function e(a,b){var e,g=c.isArray(b.items)?b.items:[b.items],h=g.length,j={create:"New",update:"Update","delete":"Delete"};for(e=0;h>e;e++){var k=g[e];i+=d.format('<Method ID="{methodId}"><SetList>%{list}%</SetList><SetVar Name="Cmd">{cmd}</SetVar>',{methodId:(k.Id?k.Id+","+j[b.method]:j[b.method])+","+a,list:a,cmd:"delete"===b.method?"Delete":"Save"}),f(k),i+="</Method>"}}function f(a){var b;i+=d.format('<SetVar Name="ID">{itemId}</SetVar>',{itemId:a.Id||"New"});for(b in a)a.hasOwnProperty(b)&&"Id"!==b&&(i+=d.format('<SetVar Name="urn:schemas-microsoft-com:office:office#{0}"><![CDATA[{1}]]></SetVar>',b,a[b]))}a=c.isArray(a)?a:[a];var g,h=a.length,i="";for(i='<Batch><ows:Batch OnError="Continue"  xmlns:ows="http://www.corasworks.net/2012/ows">',g=0;h>g;g++)b(a[g]);return i+="</ows:Batch></Batch>"}var c=a("jquery"),d=a("fn/common");return b}),c("getListItems/convertFilter2Caml",["require","jquery","fn/common"],function(a){function b(a,b){function h(a,b){var e,j="",l=a.filters,m=f[a.logic||"And"];e="undefined"!=typeof b?parseInt(b.substring(b.lastIndexOf(".")+1),10):0,e>0&&e%2===0&&(k.unshift(k[0]),k.push(k[0].replace("<","</"))),k.push(d.format("<{0}>","undefined"!=typeof b?g[m]:m)),c.each(l,function(a,c){if(j=b?b+"."+a.toString():a.toString(),"undefined"!=typeof c.logic)h(c,j);else{if(a>1){var e=k.lastIndexOf("<"+g[m]+">")+1;-1===e?k.unshift(d.format("<{0}>",m)):k.splice(e,0,d.format("<{0}>",m)),k.push(d.format("</{0}>",m))}k.push(i(c))}}),k.push(d.format("</{0}>",m))}function i(a){a=c.isArray(a)?a[0]:a;var f,g="<{0}><FieldRef Name='{1}' /><Value Type='{2}'>{3}</Value></{0}>",h=a.value,i=e[a.operator],j=a.field;if(!b[a.field])throw new Error(d.format("caps.convertFilter2Caml(). Missing model.fields defintion for {0}",a.field));return f=b[a.field].Type,d.format(g,i,j,f,h)}var j=[],k=[];if(!a)throw new Error("caps.convertFilter2Caml(). Missing required filter argument");if(!b)throw new Error("caps.convertFilter2Caml(). Missing required fields argument");return j.push("<Where>"),a&&1===a.filters.length&&a.filters[0].field?j.push(i(a.filters[0])):(h(a),j.push(k.join(""))),j.push("</Where>"),j.join("")}var c=a("jquery"),d=a("fn/common"),e={eq:"Eq",neq:"Neq",lt:"Lt",lte:"Leq",gt:"Gt",gte:"Geq",startswith:"BeginsWith",contains:"Contains"},f={and:"And",or:"Or",And:"And",Or:"Or"},g={Or:'Or Group="true"',And:'And Group="true"'};return b}),c("getListItems/convert2Caml",["require","fn/common","./convertFilter2Caml"],function(a){function b(a,b){b=b||{};var h=[];if(a.filter&&(!b||!g.checkNested(b.fields)))throw new Error("caps.getListItems({caml.filter}). Required param model.fields missing.");return h.push(d(a.sort,a.filter,b.fields)),h.push(e(a.viewFields)),h.push(c(a.rowLimit)),h.push(f(a.queryOptions)),h.join("")}function c(a){var b="";return a&&(b=g.format("<RowLimit>{0}</RowLimit>",a)),b}function d(a,b,c){function d(a){var b=[];return a=$.isArray(a)?a:[a],b.push("<OrderBy>"),$.each(a,function(a,c){var d="asc"===c.dir;b.push(g.format('<FieldRef Name="{0}" Ascending="{1}"/>',c.field,d))}),b.push("</OrderBy>"),b.join("")}var e=[];return e.push("<Query>"),a&&e.push(d(a)),b&&e.push(h(b,c)),e.push("</Query>"),e.join("")}function e(a){var b=[];return a?(a=$.isArray(a)?a:a.split(","),b.push("<ViewFields>"),$.each(a,function(a,c){b.push(g.format('<FieldRef Name="{0}" />',c))}),b.push("</ViewFields>"),b.join("")):""}function f(a){var b,c,d=[];return c={},b=$.extend({},c,a),d.push("<QueryOptions>"),$.each(b,function(a,b){d.push(g.format("<{0}>{1}</{0}>",a,b))}),d.push("</QueryOptions>"),d.join("")}var g=a("fn/common"),h=a("./convertFilter2Caml");return b}),c("fn/index",["require","./common","processBatchData/createBatchXML","getListItems/convert2Caml","getListItems/convertFilter2Caml","./events"],function(a){var b;return b=$.extend({},a("./common"),{createBatchXML:a("processBatchData/createBatchXML"),convert2Caml:a("getListItems/convert2Caml"),convertFilter2Caml:a("getListItems/convertFilter2Caml"),Events:a("./events")})}),c("helper/validate",["require","fn/common"],function(a){function b(a,b){var c=g.getListTitle;if(c=e.format(c,b||""),!a)throw new Error(c);return a}function c(a,b){var c=f?f:"",d=g.getSiteUrl,h=a?a:c,i=h.replace(/^\/+|\/+$/g,""),j=i.match(/\[.+?\]/g),k=i.match(/\%.+?\%/g);if(d=e.format(d,b||""),!i)throw new Error(d);return j||k||(i="%WebRoot%/"+i),i}function d(a,b){function c(a,b){var c=null;return e.checkNested(b,"NewDataSet",d,"ErrorInfo")&&(c=b.NewDataSet[d].ErrorInfo,caps.trigger("error",c,a,b)),e.checkNested(b,"NewDataSet","ErrorInfo")&&(c=b.NewDataSet.ErrorInfo,caps.trigger("error",c,a,b)),c}var d=a.data.RequestType;return $.Deferred(function(d){var e=c(a,b);return e?d.reject(e):void d.resolve(b)}).promise()}var e=a("fn/common"),f=window.L_Menu_BaseUrl||null,g={getSiteUrl:'caps.{0}(). Missing required "siteUrl" property and fallback method "L_Menu_BaseUrl" is undefined.',getListTitle:'caps.{0}(). Missing required "listTitle" property'};return{getListTitle:b,getSiteUrl:c,processResponse:d}}),c("checkVariables/index",["require","jquery","fn/common","helper/validate"],function(a){function b(a,b){a=a||{};var g;return g=d.extend(!0,c,{data:{}},b),e.getPromise(g).then(function(a){return"json"===g.data.OutputType?f.processResponse(g,a):void 0})}var c,d=a("jquery"),e=a("fn/common"),f=a("helper/validate");return c={type:"GET",data:{RequestType:"CheckVariables",OutputType:"json"}},b}),c("getActionDefinitions/index",["require","jquery","fn/common","helper/validate"],function(a){function b(a,b){a=a||{};var g;return g=d.extend(!0,c,{data:{SiteUrl:f.getSiteUrl(a.siteUrl,"getActionDefinitions"),ListTitle:f.getListTitle(a.listTitle)}},b),e.getPromise(g).then(function(a){return"json"===g.data.OutputType?f.processResponse(g,a):void 0})}var c,d=a("jquery"),e=a("fn/common"),f=a("helper/validate");return c={type:"GET",data:{RequestType:"GetActionDefinitions",OutputType:"json",DetailLevels:1}},b}),c("getActivatedSolutions/index",["require","jquery","fn/common","helper/validate"],function(a){function b(a,b){a=a||{};var g;return g=d.extend(!0,c,{SiteUrl:f.getSiteUrl(a.siteUrl,"getActivatedSolutions")},b),e.getPromise(g).then(function(a){return"json"===g.data.OutputType?f.processResponse(g,a):void 0})}var c,d=a("jquery"),e=a("fn/common"),f=a("helper/validate");return c={type:"GET",data:{RequestType:"GetActivatedSolutions",OutputType:"json"}},b}),c("getGlobalVariables/index",["require","jquery","fn/common","helper/validate"],function(a){function b(a,b){a=a||{};var g;return g=d.extend(!0,c,{data:{}},b),e.getPromise(g).then(function(a){return"json"===g.data.OutputType?f.processResponse(g,a):void 0})}var c,d=a("jquery"),e=a("fn/common"),f=a("helper/validate");return c={type:"GET",data:{RequestType:"GetGlobalVariables",OutputType:"json"}},b}),c("getListInfo/index",["require","jquery","fn/common","helper/validate"],function(a){function b(a,b){a=a||{};var h;return h=e.extend(!0,d,{data:{SiteUrl:g.getSiteUrl(a.siteUrl,"getListInfo"),ListTitle:c(a)}},b),f.getPromise(h).then(function(a){return"json"===h.data.OutputType?g.processResponse(h,a):void 0})}function c(a){return a.listTitle||""}var d,e=a("jquery"),f=a("fn/common"),g=a("helper/validate");return d={type:"GET",data:{RequestType:"GetListInfo",OutputType:"json"}},b}),c("getListItems/index",["require","jquery","fn/common","helper/validate","./convert2Caml"],function(a){function b(a,b){a=a||{};var h,i;return h={SiteUrl:f.getSiteUrl(a.siteUrl,"getListItems"),ListTitle:f.getListTitle(a.listTitle,"getListItems")},a.caml&&(h.CAML=g(a.caml,a.model)),i=d.extend(!0,c,{data:h},b),e.getPromise(i).then(function(a){return"json"===i.data.OutputType?f.processResponse(i,a):void 0})}var c,d=a("jquery"),e=a("fn/common"),f=a("helper/validate"),g=a("./convert2Caml");return c={type:"GET",data:{RequestType:"GetListItems",OutputType:"json"}},b}),c("getServerInfo/index",["require","jquery","fn/common","helper/validate"],function(a){function b(a,b){a=a||{};var g;return g=d.extend(!0,c,{data:{}},b),e.getPromise(g).then(function(a){return"json"===g.data.OutputType?f.processResponse(g,a):void 0})}var c,d=a("jquery"),e=a("fn/common"),f=a("helper/validate");return c={type:"GET",data:{RequestType:"GetServerInfo",OutputType:"json"}},b}),c("getSiteCollection/index",["require","jquery","fn/common","helper/validate"],function(a){function b(a,b){a=a||{};var g;return g=d.extend(!0,c,{data:{}},b),e.getPromise(g).then(function(a){return"json"===g.data.OutputType?f.processResponse(g,a):void 0})}var c,d=a("jquery"),e=a("fn/common"),f=a("helper/validate");return c={type:"GET",data:{RequestType:"GetSiteCollection",OutputType:"json"}},b}),c("getSiteInfo/index",["require","jquery","fn/common","helper/validate"],function(a){function b(a,b){a=a||{};var g;return g=d.extend(!0,c,{data:{}},b),e.getPromise(g).then(function(a){return"json"===g.data.OutputType?f.processResponse(g,a):void 0})}var c,d=a("jquery"),e=a("fn/common"),f=a("helper/validate");return c={type:"GET",data:{RequestType:"GetSiteInfo",OutputType:"json"}},b}),c("getSiteUsers/index",["require","jquery","fn/common","helper/validate"],function(a){function b(a,b){a=a||{};var g;return g=d.extend(!0,c,{data:{}},b),e.getPromise(g).then(function(a){return"json"===g.data.OutputType?f.processResponse(g,a):void 0})}var c,d=a("jquery"),e=a("fn/common"),f=a("helper/validate");return c={type:"GET",data:{RequestType:"GetSiteUser",OutputType:"json"}},b}),c("getVersion/index",["require","jquery","fn/common","helper/validate"],function(a){function b(a,b){a=a||{};var g;return g=d.extend(!0,c,{data:{}},b),e.getPromise(g).then(function(a){return"json"===g.data.OutputType?f.processResponse(g,a):void 0})}var c,d=a("jquery"),e=a("fn/common"),f=a("helper/validate");return c={type:"GET",data:{RequestType:"GetVersion",OutputType:"json"}},b}),c("getWebPartPageTemplates/index",["require","jquery","fn/common","helper/validate"],function(a){function b(a,b){a=a||{};var g;return g=d.extend(!0,c,{data:{}},b),e.getPromise(g).then(function(a){return"json"===g.data.OutputType?f.processResponse(g,a):void 0})}var c,d=a("jquery"),e=a("fn/common"),f=a("helper/validate");return c={type:"GET",data:{RequestType:"GetWebPartPageTemplates",OutputType:"json"}},b}),c("getWebPartProperties/index",["require","jquery","fn/common","helper/validate"],function(a){function b(a,b){a=a||{};var g;return g=d.extend(!0,c,{data:{}},b),e.getPromise(g).then(function(a){return"json"===g.data.OutputType?f.processResponse(g,a):void 0})}var c,d=a("jquery"),e=a("fn/common"),f=a("helper/validate");return c={type:"GET",data:{RequestType:"GetWebPartProperties",OutputType:"json"}},b}),c("processBatchData/index",["require","jquery","fn/common","helper/validate","./createBatchXML"],function(a){function b(a,b){a=a||{};var j,k,l,m;return j=h.getSiteUrl(a.siteUrl,"processBatchData"),k=c(a),l=i(d(a)),m=f.extend(!0,e,{data:{SiteUrl:j,ListTitle:k,Batch:l}},b),g.getPromise(m)}function c(a){var b="";if(b=f.map(a,function(a){return a.listTitle}).join(","),!b)throw new Error('caps.processBatchData(). Missing required "listTitle" property.');return b}function d(a){if(!a&&!a.batch)throw new Error('caps.processBatchData(). Missing required "batch" property.');return a.batch}var e,f=a("jquery"),g=a("fn/common"),h=a("helper/validate"),i=a("./createBatchXML");return e={type:"POST",data:{RequestType:"ProcessBatchData",OutputType:"json"}},b}),c("caps",["require","jquery","fn/events","helper/polyfills","fn/index","checkVariables/index","getActionDefinitions/index","getActivatedSolutions/index","getGlobalVariables/index","getListInfo/index","getListItems/index","getServerInfo/index","getSiteCollection/index","getSiteInfo/index","getSiteUsers/index","getVersion/index","getWebPartPageTemplates/index","getWebPartProperties/index","processBatchData/index"],function(a){var b,c=(a("jquery"),a("fn/events")),d="0.19.1";return a("helper/polyfills"),b={fn:a("fn/index"),version:d,checkVariables:a("checkVariables/index"),getActionDefinitions:a("getActionDefinitions/index"),getActivatedSolutions:a("getActivatedSolutions/index"),getGlobalVariables:a("getGlobalVariables/index"),getListInfo:a("getListInfo/index"),getListItems:a("getListItems/index"),getServerInfo:a("getServerInfo/index"),getSiteCollection:a("getSiteCollection/index"),getSiteInfo:a("getSiteInfo/index"),getSiteUsers:a("getSiteUsers/index"),getVersion:a("getVersion/index"),getWebPartPageTemplates:a("getWebPartPageTemplates/index"),getWebPartProperties:a("getWebPartProperties/index"),processBatchData:a("processBatchData/index")},c.includeIn(b),b}),c("jquery",function(){return $}),b("caps")});