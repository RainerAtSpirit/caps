/*! caps 2013-10-02 
* Copyright (c) 1998, 2013 Spirit EDV-Beratung AG 
* Available via the MIT license.
* see: https://github.com/RainerAtSpirit/caps for details.
*/
!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],b):a.caps=b(a.$)}(this,function(a){var b,c,d;return function(a){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m=b&&b.split("/"),n=s.map,o=n&&n["*"]||{};if(a&&"."===a.charAt(0))if(b){for(m=m.slice(0,m.length-1),a=m.concat(a.split("/")),j=0;j<a.length;j+=1)if(l=a[j],"."===l)a.splice(j,1),j-=1;else if(".."===l){if(1===j&&(".."===a[2]||".."===a[0]))break;j>0&&(a.splice(j-1,2),j-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((m||o)&&n){for(c=a.split("/"),j=c.length;j>0;j-=1){if(d=c.slice(0,j).join("/"),m)for(k=m.length;k>0;k-=1)if(e=n[m.slice(0,k).join("/")],e&&(e=e[d])){f=e,g=j;break}if(f)break;!h&&o&&o[d]&&(h=o[d],i=j)}!f&&h&&(f=h,g=i),f&&(c.splice(0,g,f),a=c.join("/"))}return a}function g(b,c){return function(){return n.apply(a,v.call(arguments,0).concat([b,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(b){if(e(r,b)){var c=r[b];delete r[b],t[b]=!0,m.apply(a,c)}if(!e(q,b)&&!e(t,b))throw new Error("No "+b);return q[b]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(b,c,d,f){var h,k,l,m,n,s,u=[];if(f=f||b,"function"==typeof d){for(c=!c.length&&d.length?["require","exports","module"]:c,n=0;n<c.length;n+=1)if(m=o(c[n],f),k=m.f,"require"===k)u[n]=p.require(b);else if("exports"===k)u[n]=p.exports(b),s=!0;else if("module"===k)h=u[n]=p.module(b);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(b+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=d.apply(q[b],u),b&&(h&&h.exports!==a&&h.exports!==q[b]?q[b]=h.exports:l===a&&s||(q[b]=l))}else b&&(q[b]=d)},b=c=n=function(b,c,d,e,f){return"string"==typeof b?p[b]?p[b](c):j(o(b,c).f):(b.splice||(s=b,c.splice?(b=c,c=d,d=null):b=a),c=c||function(){},"function"==typeof d&&(d=e,e=f),e?m(a,b,c,d):setTimeout(function(){m(a,b,c,d)},4),n)},n.config=function(a){return s=a,s.deps&&n(s.deps,s.callback),n},b._defined=q,d=function(a,b,c){b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},d.amd={jQuery:!0}}(),d("almond",function(){}),d("config",[],function(){var a="/_layouts/CorasWorksApps/CorasWorksApplicationService.ashx",b="0.1.0",c={url:a,cache:!0,dataType:"json",type:"POST"};return{VERSION:b,settings:c}}),d("fn",[],function(){function a(a){for(var b=Array.prototype.slice.call(arguments),a=b.shift(),c=0;c<b.length;c++){if(!a.hasOwnProperty(b[c]))return!1;a=a[b[c]]}return!0}function b(a,b){return b="object"==typeof b?b:Array.prototype.slice.call(arguments,1),a.replace(/\{\{|\}\}|\{(\w+)\}/g,function(a,c){return"{{"==a?"{":"}}"==a?"}":b[c]})}return{checkNested:a,format:b}}),d("ops/pbd/createBatchXML",["jquery","fn"],function(a,b){var c=function(){this.methods=""};return a.extend(c.prototype,{create:function(b){var c=a.isArray(b)?b:[b],d=this;return d.methods='<Batch><ows:Batch OnError="Continue"  xmlns:ows="http://www.corasworks.net/2012/ows">',a.each(c,function(a,b){d.processList(b)}),d.methods+="</ows:Batch></Batch>",d.methods},processList:function(b){var c=this,d=a.isArray(b.batch)?b.batch:[b.batch];a.each(d,function(a,d){c.processItems(b.name,d)})},processItems:function(c,d){var e=this,f=a.isArray(d.items)?d.items:[d.items],g={create:"New",update:"Update","delete":"Delete"};a.each(f,function(a,f){e.methods+=b.format('<Method ID="{methodId}"><SetList>%{list}%</SetList><SetVar Name="Cmd">{cmd}</SetVar>',{methodId:(f.Id?f.Id+","+g[d.method]:g[d.method])+","+c,list:c,cmd:"delete"===d?"Delete":"Save"}),e.processProps(f),e.methods+="</Method>"})},processProps:function(c){var d=this;d.methods+=b.format('<SetVar Name="ID">{itemId}</SetVar>',{itemId:c.Id||"New"}),a.each(c,function(a,c){"Id"!==a&&(d.methods+=b.format('<SetVar Name="urn:schemas-microsoft-com:office:office#{0}"><![CDATA[{1}]]></SetVar>',a,c))})}}),c}),d("ops/processBatchData",["jquery","config","ops/pbd/createBatchXML"],function(a,b,c){function d(a){return f.create(a)}function e(c,d){c=a.isArray(c)?c:[c];var e=a.extend(!0,{},b.settings,{data:{RequestType:"ProcessBatchData",SiteUrl:"%WebRoot%/"+c[0].site,ListTitle:a.map(c,function(a){return a.name}).join(","),OutputType:"json",Batch:f.create(c)}},d);return a.ajax(e)}var f=new c;return{createBatchXML:d,makeRequest:e}}),d("caps",["config","fn","ops/processBatchData"],function(a,b,c){return{VERSION:a.VERSION,settings:a.settings,fn:b,processBatchData:c}}),d("jquery",function(){return a}),c("caps")});